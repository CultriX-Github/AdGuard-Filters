! =============================================================================
! Title: Combined Optimal AdGuard DNS Filter (Improved)
! Description: DNS-only rules for AdGuard DNS. Safe defaults + practical allows.
! Version: v1.2.0
! Last Updated: 2025-11-11
!
! CHANGELOG (v1.4.1):
! ‚Ä¢ Added PKI staple for older Let's Encrypt chains.
! ‚Ä¢ Added performance note for broad tracking regex.
! ‚Ä¢ Fixed typo in Section 14 divider.
!
! HOW THIS LIST IS DESIGNED
! ‚Ä¢ DNS context only (no cosmetic rules, no path/param matching).
! ‚Ä¢ Specific domains first (fast, predictable) ‚Üí regex patterns (carefully scoped).
! ‚Ä¢ Allow rules:
!¬† 	  ‚Äì Plain @@ rules keep $important (higher priority).
!¬† 	  ‚Äì Regex @@ rules omit modifiers for stability.
! ‚Ä¢ ‚ÄúAGGRESSIVE‚Äù blocks and ‚ÄúOPTIONAL‚Äù allows are off by default ‚Äî enable consciously.
!
! DEBUGGING PLAYBOOK (quick)
! 1) In AdGuard logs filter by ‚ÄúBlocked by custom filtering rules‚Äù.
! 2) If breakage is from a regex, allowlist the exact domain with @@||domain.tld^
! 3) Prefer adding per-site @@ over deleting a global block rule.
! 4) If TLS/SSO fails sporadically, check OCSP/PKI allows below.
!
! TUNING PLAYBOOK (personalize your list)
! 1) Find New Blocks: Check your "Allowed" query log for tracker-like domains 
!    (e.g., telemetry.app-you-use.com) and add them to the blocklist.
! 2) Find False Positives: Check your "Blocked" log for legitimate services 
!    that are broken. Add them to "Section 14: QUICK UNBREAK EXAMPLES"
!    (e.g., @@||service.that-broke.com^).
!
! REGEX NOTES (important)
! ‚Ä¢ All regexes match the FULL hostname (we anchor with ^ and $).
! ‚Ä¢ End-of-domain class uses [a-z.]{2,} to tolerate multi-label TLDs (e.g., co.uk).
! ‚Ä¢ Keep regex count modest: they evaluate on each query. Favor plain domains where possible.
! =============================================================================


! =============================================================================
! üõë 1. CORE AD BLOCKING
! Purpose: high-signal ad networks; minimal false positives.
! =============================================================================

! --- 1.1 Major Ad Networks (Specific Domains) ---
||aaxads.com^
||adnxs.com^
||adservice.google.com^
||advertising.com^
||amazon-adsystem.com^
||ads.yahoo.com^
||adsrvr.org^
||bidswitch.net^
||casalemedia.com^
||criteo.com^
||doubleclick.net^
||googlesyndication.com^
||moatads.com^
||openx.net^
||outbrain.com^
||pubmatic.com^
||rubiconproject.com^
||taboola.com^

! --- 1.2 Ad Domain Patterns (DNS-safe regex)
! Matches hostnames whose registrable part is ad/advert/‚Ä¶; avoids path/param.
/^(?:[a-z0-9-]+\.)*(?:ad(?:s?[xv]?|serv(?:er|ice)?s?)|advert(?:is(?:e|ing)|ements?)|banners?)\.[a-z.]{2,}$/

! Targeted extras (incremental coverage; still anchored to full hostname)
! Legacy, still seen in the wild:
/^(?:[a-z0-9-]+\.)*adchoice\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*adsdk\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*adsystem\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*aff(?:iliat(?:es|ion))?\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*flashtalking\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*yieldmanager\.[a-z.]{2,}$/


! =============================================================================
! üì∫ 2. PLATFORM-SPECIFIC AD BLOCKING
! Notes: These are common for TVs/streamers & social SDKs. Some devices degrade ads stats but continue to function.
! =============================================================================

! Specific domains (sorted)
||ads-bidder-api.twitter.com^
||ads-resources-client.vizio.com^
||advertising-api.pinterest.com^
||advertising.roku.com^
||analytics.pinterest.com^
||app-measurement.com^
||lgads.tv^
||log-upload.facebook.com^
||log-upload.instagram.com^
||log.pinterest.com^
||samsungads.com^
||telemetry.sdk.roku.com^
||tvx.adgrx.com^

! Regex (sorted by target hostname)
/^(?:[a-z0-9-]+\.)*ads-api\.amazon\.com$/
/^(?:[a-z0-9-]+\.)*ads\.facebook\.com$/
/^(?:[a-z0-9-]+\.)*ads\.linkedin\.com$/
/^(?:[a-z0-9-]+\.)*ads\.reddit\.com$/
/^(?:[a-z0-9-]+\.)*ads\.snapchat\.com$/
/^(?:[a-z0-9-]+\.)*ads\.tiktok\.com$/
/^(?:[a-z0-9-]+\.)*ads\.twitter\.com$/
/^(?:[a-z0-9-]+\.)*clicks\.beap\.bc\.yahoo\.com$/
/^(?:[a-z0-9-]+\.)*google[_.-]?syndicat(?:e|ion)+\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*(?:ads?|captive|logs|cloudservices)\.roku\.com$/
/^(?:[a-z0-9-]+\.)*secure\.footprint\.net$/


! =============================================================================
! üîç 3. TRACKING & ANALYTICS BLOCKING
! Rationale: these are analytics/behavioral tools. Some are privacy-friendly but still trackers.
! =============================================================================

! --- 3.1 Major Analytics & Trackers (sorted) ---
||amplitude.com^
||analytics.google.com^
||bluekai.com^
||clarity.ms^
||cname-tracking.com^
||crazyegg.com^
||dynatrace.com^
||fathom.com^
||fullstory.com^
||google-analytics.com^
||heap.io^
||hotjar.com^
||kissmetrics.com^
||matomo.cloud^
||mixpanel.com^
||mouseflow.com^
||newrelic.com^
||omtrdc.net^
||optimizely.com^
||plausible.io^
||quantserve.com^
||scorecardresearch.com^
||segment.com^
||segment.io^
||sentry.io^
||statcounter.com^

! --- 3.2 Modern Analytics & Tracking (sorted) ---
||chartbeat.com^
||clicktale.net^
||commandersact.com^
||contentsquare.com^
||glassbox.com^
||hotjar.io^
||inspectlet.com^
||logrocket.com^
||permutive.com^
||posthog.com^
||tealiumiq.com^

! --- 3.3 CNAME Cloaked Trackers (Illustrative) ---
! These are first-party domains that hide third-party trackers.
! You must find these in your *own* query log, as they are unique to each site.
! ||an.example-site.com^ ! Example: CNAMEs to tracker.com
! ||log.another-website.org^ ! Example: CNAMEs to analytics-provider.net

! --- 3.4 Broad Tracking Families (keep anchors; consider perf) ---
! If you notice DNS eval cost creeping up on weak clients, trial disabling the broad family line:
/^(?:[a-z0-9-]+\.)*(?:track(?:er|ing)?|analytics?|telemetry|pixel(?:s)?|beacons?|metrics?)\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*(?:crashlytics|behavior|data-collect)\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*(?:fingerprint|device-id)\.[a-z.]{2,}$/


! Lighter alternatives (swap in if needed):
! /^(?:[a-z0-9-]+\.)*(?:track(?:er|ing)?)\.[a-z.]{2,}$/
! /^(?:[a-z0-9-]+\.)*analytics?\.[a-z.]{2,}$/
! /^(?:[a-z0-9-]+\.)*telemetry\.[a-z.]{2,}$/


! =============================================================================
! ‚õèÔ∏è 4. CRYPTOCURRENCY MINING & ABUSE
! =============================================================================
||authedmine.com^
||browsermine.com^
||coin-hive.com^
||coinhive.com^
||coinlab.biz^
||crypto-loot.com^
||cryptoloot.pro^
||deepminer.org^
||freecontent.date^
||hashvault.pro^
||jsecoin.com^
||minero.cc^
||moneroocean.stream^
||monerominer.rocks^
||redshell.io^
||webmine.pro^
||webminepool.com^


! =============================================================================
! ‚ö†Ô∏è 5. SCAM & FRAUD BLOCKING
! Kept to clearly malicious signals to avoid harming threat intel access.
! =============================================================================
||claim-reward.net^
||free-money.site^
||verify-your-account.com^

/^(?:[a-z0-9-]+\.)*(?:crypto|bitcoin|ether|nft|scam|phish)[_-](?:gift|promo|airdrop)\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*(?:d[ilsc]{2,}rds?-?(?:g[il]ft|n[il]tro)|gifts?-?discord)\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*(?:free|get|claim|reward|prize|winner|youve-won)\.[a-z.]{2,}$/


! =============================================================================
! ü¶† 6. MALWARE & PHISHING PROTECTION
! =============================================================================

! --- 6.1 High-Confidence Threat Domains ---
! This section is for specific, known-malicious domains.
! It is best populated by a dedicated threat-intel feed (e.g., OISD, Firebog).
! Examples of what would go here:
! ||phishing-site-123.xyz^
! ||malware-c2-server.net^
! ||ransomware-drop.com^

! --- 6.2 Nuisance & Generic Phishing Domains ---
||browser-update.info^
||download-software.net^
||fakeupdate.net^
||flash-player-update.com^
||install-app.net^
||mackeeper.com^
||malware-check.online^
||ransom-payment.xyz^
||security-breach-alert.com^
||system-check-required.info^
||tinyurl.is^
||update-flash.com^
||virus-detector.site^
||windows-defender-alert.com^
||your-computer-is-infected.com^

! --- 6.3 Malware & Phishing Domain Patterns ---
/^(?:[a-z0-9-]+\.)*(?:malware|spyware|ransomware|virus|trojan|worm)\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*(?:scan|clean|remove|detect|protect|security)-(?:virus|malware|spyware)\.[a-z.]{2,}$/


! =============================================================================
! ‚öôÔ∏è 7. UNWANTED SERVICES & TELEMETRY (CONSERVATIVE)
! May affect push, crash logs, or A/B testing. Allow per app if needed.
! =============================================================================
||adjust.com^
||appsflyer.com^
||branch.io^
||braze.com^
||bugsnag.com^
||firebase.com^
||firebaseio.com^
||flurry.com^
||kochava.com^
||leanplum.com^
||onesignal.com^
||pushwoosh.com^
||urbanairship.com^

/^(?:[a-z0-9-]+\.)*(?:clicktale|mouseflow)\.[a-z.]{2,}$/
/^(?:[a-z0-9-]+\.)*(?:survey(?:link)?|stats?)\.[a-z.]{2,}$/


! =============================================================================
! üè† 8. IoT DEVICE TRACKING
! Heads-up: diagnostics may degrade; allowlist per device if you need stability.
! =============================================================================
||analytics.sonos.com^
||api.smartthings.com^
||blink-app-service.lamarzocco.io^
||crashlytics.googleapis.com^
||data.alexa.amazon.com^
||gcloudiap.googleapis.com^
||iot-analytics.amazon.com^
||logs.ecobee.com^
||metrics.apple.com^
||metrics.nest.com^
||stats.govee.com^
||telemetry.philips-hue.com^


! =============================================================================
! üé• 9. VIDEO CONFERENCING TELEMETRY
! If meetings glitch, test by allowlisting the affected vendor below.
! =============================================================================
||analytics.bluejeans.com^
||analytics.skype.com^
||analytics.zoom.us^
||browser-intake-datadoghq.com^
||rtc-telemetry.microsoft.com^
||telemetry.teams.microsoft.com^
||telemetry.webex.com^


! =============================================================================
! üöß 10. AGGRESSIVE (OPTIONAL ‚Äî COMMENTED OUT)
! These rules can break functionality. Uncomment (`!||` -> `||`) to enable.
! =============================================================================

! --- 10.1 Desktop Software Telemetry (Optional) ---
! Blocks data collection from common desktop/productivity apps.
! May break license checks or automatic updates.
! ||telemetry.visualstudio.com^
! ||data.figma.com^
! ||data.services.jetbrains.com^
! ||telemetry.docker.com^

! --- 10.2 Aggressive Web Services (Optional) ---
! These often break support portals or embedded help. Enable if you want them gone.
! ||freshchat.com^
! ||intercom.io^
! ||salesforceliveagent.com^
! ||sessioncam.com^
! ||sitescout.com^
! ||smartlook.com^
! ||userreplay.com^
! ||zendesk.com^


! =============================================================================
! ‚úÖ 11. ESSENTIAL WHITELIST ‚Äî CORE SERVICES & INFRA
! $important ‚Üí wins over blocks. Keep this lean & boring.
! =============================================================================
@@||accounts.google.com^$important
@@||adaway.org^$important
@@||ajax.googleapis.com^$important
@@||api.telegram.org^$important
@@||archlinux.org^$important
@@||brave.com^$important
@@||cdn.jsdelivr.net^$important
@@||cdnjs.cloudflare.com^$important
@@||cloudflare.com^$important
@@||content.googleapis.com^$important
@@||dbl.oisd.nl^$important
@@||debian.org^$important
@@||duck.com^$important
@@||duckduckgo.com^$important
@@||easylist.to^$important
@@||fedoraproject.org^$important
@@||filterlists.com^$important
@@||fonts.googleapis.com^$important
@@||fonts.gstatic.com^$important
@@||ggpht.com^$important
@@||gitcdn.xyz^$important
@@||github.com^$important
@@||githubusercontent.com^$important
@@||gitlab.com^$important
@@||googleapis.com^$important
@@||kernel.org^$important
@@||linux.org^$important
@@||login.microsoftonline.com^$important
@@||mozilla.org^$important
@@||opensuse.org^$important
@@||paypal.com^$important
@@||paypalobjects.com^$important
@@||pgl.yoyo.org^$important
@@||proton.me^$important
@@||protonmail.com^$important
@@||signal.org^$important
@@||stackoverflow.com^$important
@@||startpage.com^$important
@@||stripe.com^$important
@@||torproject.org^$important
@@||ubuntu.com^$important
@@||unpkg.com^$important
@@||wikimedia.org^$important
||wikipedia.org^$important
@@||youtube.com^$important
@@||youtu.be^$important
@@||ytimg.com^$important

! Connectivity & time (prevent false ‚Äúoffline‚Äù states)
@@||captive.apple.com^$important
@@||connectivitycheck.android.com^$important
@@||connectivitycheck.gstatic.com^$important
@@||detectportal.firefox.com^$important
@@||msftconnecttest.com^$important
@@||msftncsi.com^$important
@@||ntp.org^$important
@@||pool.ntp.org^$important
@@||time.apple.com^$important
@@||time.cloudflare.com^$important
@@||time.google.com^$important
@@||time.windows.com^$important

! Identity / SSO / CAPTCHA
@@||auth0.com^$important
@@||hcaptcha.com^$important
@@||identity.netlify.com^$important
@@||okta.com^$important
@@||recaptcha.net^$important

! CDNs (typical static asset delivery)
@@||akamai.net^$important
@@||akamaized.net^$important
! @@||content.googleapis.com^$important ! Duplicate, already listed above
@@||fastly.net^$important
@@||gstatic.com^$important

! OCSP / PKI (TLS stability during browsing & auth)
@@||ocsp.apple.com^$important
@@||ocsp.digicert.com^$important
@@||ocsp.globalsign.com^$important
@@||ocsp.godaddy.com^$important
@@||ocsp.int-x3.letsencrypt.org^$important
@@||ocsp.msocsp.com^$important
@@||ocsp.pki.goog^$important
@@||ocsp.sectigo.com^$important
@@||ocsp.usertrust.com^$important
@@||r3.o.lencr.org^$important


! =============================================================================
! ‚úÖ 12. ESSENTIAL WHITELIST ‚Äî DNS-SAFE REGEX
! No $domain or $important on regex allows (keeps parser happy).
! =============================================================================
@@/^auth\..*\.com$/
@@/^clients[0-9]*\.google\.(?:com|[a-z.]{2,})$/
@@/^identity\..*\.com$/
@@/^oauth\..*\.com$/
@@/^sso\..*\.com$/
@@/^(?:cdn|api|login|accounts)\.(?:github|gitlab)\.(?:com|io)$/
@@/^(?:[a-z0-9-]+\.)*(?:spotify|reddit(?:media)?|mega|soundcloud)\.(?:com|nl|io|tw|se|do)$/


! =============================================================================
! ‚ûï 13. OPTIONAL WHITELISTS (toggle as needed)
! Keep commented until you observe breakage tied to these.
! =============================================================================

! Utilities / IP checkers
@@/^ipv(?:4|6)\.icanhazip\.com$/
@@||api.ipify.org^
@@||checkip.amazonaws.com^
@@||icanhazip.com^
@@||ifconfig.me^
@@||ipinfo.io^
@@||wtfismyip.com^

! Gaming platforms (active)
@@||amd.com^
@@||ea.com^
@@||epicgames.com^
@@||gog.com^
@@||nvidia.com^
@@||origin.com^
@@||riotgames.com^
@@||steamcdn-a.akamaihd.net^
@@||steamcommunity.com^
@@||steampowered.com^

! Gaming platforms (commented; enable if needed)
!@@||battle.net^
!@@||blizzard.com^
!@@||playstation.com^
!@@||xbox.com^
!@@||xboxlive.com^

! Torrents / trackers (volatile; many mirrors change)
@@||1337x.to^
@@||explodie.org^
@@||iptorrents.com^
@@||ipv4.tracker.harry.lu^
@@||limetorrents.cc^
@@||nyaa.si^
@@||rarbg.to^
@@||thepiratebay.org^
@@||torrentgalaxy.to^
@@||tracker.bt4g.com^
@@||tracker.coppersurfer.tk^
@@||tracker.dler.org^
@@||tracker.gbitt.info^
@@||tracker.internetwarriors.net^
@@||tracker.leechers-paradise.org^
@@||tracker.nanoha.org^
@@||tracker.openbittorrent.com^
@@||tracker.opentrackr.org^
@@||tracker.torrent.eu.org^
@@||tracker2.itzmx.com^
@@||yts.mx^

! Adult (NSFW) ‚Äî optional
! Note: Added redtube, spankbang, and common live cam sites.
@@/^(?:[a-z0-9-]+\.)*(?:pornhub|xnxx|xvideos|xhamster|youporn|redtube|spankbang|chaturbate|bongacams|livejasmin)\.(?:com|nl|io|tw|se|do)$/

! =============================================================================
! ‚úÖ 14. QUICK UNBREAK EXAMPLES
! Use these as temporary toggles while you investigate root cause.
! =============================================================================
! @@||discovery.meethue.com^
! @@||firebaseio.com^
! @@||intercom.io^
! @@||onesignal.com^
! @@||zendesk.com^

! =============================================================================
! ‚ÑπÔ∏è 15. MAINTAINER NOTES
! =============================================================================
! ‚Ä¢ Order doesn‚Äôt affect DNS matching, but keeping sections tidy helps diffing.
! ‚Ä¢ Punycode: IDNs appear as xn--*. Add rules using the punycode form if needed.
! ‚Ä¢ CNAME cloaking: AdGuard can detect some CNAMEs; still, block root trackers directly (as above).
! ‚Ä¢ Alternative resolvers: do NOT allowlist public DoH/DoT endpoints unless you want clients bypassing AdGuard.
! ‚Ä¢ If you see latency spikes, trim regex count (start with the broad tracking line).
! ‚Ä¢ Review whitelists: Periodically review your @@ rules. An unneeded or compromised 
!   whitelist (like the historic polyfill.io case) is a security risk.
! =============================================================================
